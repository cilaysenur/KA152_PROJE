<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Y√∂netim Paneli | KA152</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #0f172a; color: white; }
        .fixed-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.98)),
            url('https://images.unsplash.com/photo-1506012787146-f92b2d7d6d96?auto=format&fit=crop&w=1920&q=80');
            background-size: cover; background-position: center; z-index: -1;
        }
        .glass-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.08); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); }
        .input-glass { background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255, 255, 255, 0.1); color: white; transition: all 0.3s ease; }
        .input-glass:focus { outline: none; border-color: #3b82f6; background: rgba(15, 23, 42, 0.9); box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1); }
        .cursor-grab { cursor: grab; } .cursor-grab:active { cursor: grabbing; }
        .sortable-ghost { opacity: 0.4; background: #3b82f6; border: 2px dashed white; } 
        .sortable-drag { background: #1e293b; opacity: 1; transform: scale(1.02); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5); z-index: 9999; }
        .drag-handle { cursor: grab; padding: 10px; } .drag-handle:active { cursor: grabbing; }
        ::-webkit-calendar-picker-indicator { filter: invert(1); }
    </style>
</head>
<body class="p-6 md:p-12 min-h-screen">
    <div class="fixed-bg"></div>
    <script>
        const DB_URL = "https://ka152-proje-default-rtdb.firebaseio.com"; 
        if (localStorage.getItem("admin") !== "true") window.location.href = "admin-login.html";
    </script>

    <header class="max-w-5xl mx-auto glass-card rounded-2xl p-6 mb-8 flex justify-between items-center sticky top-4 z-50">
        <h1 class="text-xl font-bold text-white">Y√∂netim Paneli</h1>
        <div class="flex gap-3">
            <a href="index.html" target="_blank" class="px-4 py-2 rounded-lg border border-white/10 hover:bg-white/5 text-sm font-bold text-slate-300">Siteye Git ‚Üó</a>
            <button onclick="cikis()" class="px-4 py-2 rounded-lg bg-red-500/10 border border-red-500/20 text-red-400 text-sm font-bold hover:bg-red-500/20">√áƒ±kƒ±≈ü</button>
        </div>
    </header>

    <div class="max-w-5xl mx-auto space-y-8 pb-24">
        
        <div class="grid md:grid-cols-2 gap-8">
            <div class="glass-card p-6 rounded-3xl border-l-4 border-l-yellow-500">
                <h2 class="text-lg font-bold text-white mb-4">üì© Gelen Mesajlar</h2>
                <div id="mesaj-kutusu" class="space-y-3 max-h-40 overflow-y-auto"><p class="text-slate-500 text-xs italic">Y√ºkleniyor...</p></div>
            </div>
            <div class="glass-card p-6 rounded-3xl border-l-4 border-l-green-500">
                <h2 class="text-lg font-bold text-white mb-4">üìß E-B√ºlten Aboneleri</h2>
                <div id="abone-kutusu" class="flex flex-wrap gap-2 max-h-40 overflow-y-auto"><p class="text-slate-500 text-xs italic">Y√ºkleniyor...</p></div>
            </div>
        </div>

        <hr class="border-white/10">

        <div class="glass-card p-8 rounded-3xl">
            <h2 class="text-xl font-bold text-white mb-4">‚è±Ô∏è Geri Sayƒ±m Tarihi</h2>
            <input type="datetime-local" id="inp-tarih" class="input-glass w-full p-4 rounded-xl">
        </div>

        <div class="glass-card p-8 rounded-3xl border-l-4 border-l-cyan-500">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-white">ü§ù Proje Ortaklarƒ±</h2>
                <span class="text-xs bg-cyan-900/50 text-cyan-300 px-2 py-1 rounded">Sƒ±ralamak i√ßin ‚ò∞ ikonundan s√ºr√ºkleyin</span>
            </div>
            <div class="grid md:grid-cols-3 gap-3 mb-4">
                <input type="text" id="ortak-ad" placeholder="Kurum Adƒ±" class="input-glass p-3 rounded-xl">
                <input type="text" id="ortak-rol" placeholder="Rol√º" class="input-glass p-3 rounded-xl">
                <input type="text" id="ortak-logo" placeholder="Logo Linki (Bo≈üsa harf olur)" class="input-glass p-3 rounded-xl">
            </div>
            <button onclick="ortakEkle()" class="w-full py-2 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded-xl mb-4">+ Ortak Ekle</button>
            <ul id="ortak-listesi" class="space-y-3 min-h-[50px]"></ul>
        </div>

        <div class="glass-card p-8 rounded-3xl border-l-4 border-l-blue-500">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-white">üë• Y√∂netim Ekibi</h2>
                <span class="text-xs bg-blue-900/50 text-blue-300 px-2 py-1 rounded">Sƒ±ralamak i√ßin ‚ò∞ ikonundan s√ºr√ºkleyin</span>
            </div>
            <div class="grid md:grid-cols-3 gap-3 mb-4">
                <input type="text" id="yeni-ad" placeholder="Ad Soyad" class="input-glass p-3 rounded-xl">
                <input type="text" id="yeni-gorev" placeholder="G√∂revi" class="input-glass p-3 rounded-xl">
                <input type="text" id="yeni-resim" placeholder="Resim Linki" class="input-glass p-3 rounded-xl">
            </div>
            <button onclick="ekipEkle()" class="w-full py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-xl mb-4">+ Ekip Ekle</button>
            <ul id="ekip-listesi" class="space-y-3 min-h-[50px]"></ul>
        </div>

        <div class="glass-card p-8 rounded-3xl border-l-4 border-l-purple-500">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold text-white">üì∞ Blog & Haberler</h2>
                <span class="text-xs bg-purple-900/50 text-purple-300 px-2 py-1 rounded">Sƒ±ralamak i√ßin ‚ò∞ ikonundan s√ºr√ºkleyin</span>
            </div>
            
            <div class="space-y-4 mb-6">
                <input type="text" id="blog-baslik" placeholder="Haber Ba≈ülƒ±ƒüƒ±" class="input-glass w-full p-4 rounded-xl text-lg font-bold">
                <div class="bg-purple-500/10 border border-purple-500/20 p-4 rounded-xl">
                    <label class="block text-xs text-purple-300 font-bold uppercase mb-2">üì∏ Fotoƒüraf Alanƒ±</label>
                    <input type="text" id="blog-resim" placeholder="Fotoƒüraf Linkini Buraya Yapƒ±≈ütƒ±r (√ñrn: https://...)" class="input-glass w-full p-3 rounded-xl">
                </div>
                <textarea id="blog-metin" rows="4" placeholder="Haberin i√ßeriƒüi..." class="input-glass w-full p-4 rounded-xl"></textarea>
            </div>
            
            <button onclick="blogEkle()" class="w-full py-3 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-xl shadow-lg mb-6">+ HABERƒ∞ YAYINLA</button>
            <ul id="blog-listesi" class="space-y-3 min-h-[50px]"></ul>
        </div>
    </div>

    <div class="fixed bottom-0 left-0 w-full p-4 bg-slate-900/90 backdrop-blur-xl border-t border-white/10 flex justify-center items-center gap-4 z-50">
        <span id="mesaj" class="font-bold text-green-400 hidden animate-pulse">‚úÖ G√ºncellendi!</span>
        <button onclick="kaydet()" id="btn-kaydet" class="px-10 py-3 bg-gradient-to-r from-blue-600 to-cyan-600 text-white font-bold rounded-xl shadow-lg transition-all active:scale-95">üíæ T√úM√úN√ú KAYDET</button>
    </div>

    <script>
        let ekipData = [], ortakData = [], blogData = [], mesajlarData = [], abonelerData = [];

        document.addEventListener('DOMContentLoaded', () => {
            initSortable('ekip-listesi', 'ekipData');
            initSortable('ortak-listesi', 'ortakData');
            initSortable('blog-listesi', 'blogData');
        });

        function initSortable(elId, dataVarName) {
            const el = document.getElementById(elId);
            if (!el) return;
            new Sortable(el, {
                animation: 150, handle: '.drag-handle', ghostClass: 'sortable-ghost', dragClass: 'sortable-drag',
                onEnd: function (evt) {
                    let list = window[dataVarName];
                    if (list) { const item = list.splice(evt.oldIndex, 1)[0]; list.splice(evt.newIndex, 0, item); }
                }
            });
        }

        // VERƒ∞LERƒ∞ √áEK
        fetch(DB_URL + "/veri.json").then(r => r.json()).then(data => {
            if(data) {
                document.getElementById('inp-tarih').value = data.tarih || "";
                window.ekipData = data.ekip || [];
                window.ortakData = data.ortaklar || [];
                window.blogData = data.blog || [];
                window.mesajlarData = data.mesajlar || [];
                window.abonelerData = data.aboneler || [];
                renderEkip(); renderOrtak(); renderBlog(); renderMesajlar(); renderAboneler();
            } else {
                window.ekipData = []; window.ortakData = []; window.blogData = []; window.mesajlarData = []; window.abonelerData = [];
            }
        });

        // --- ORTAK RENDER (LOGO G√úNCELLEMESƒ∞) ---
        function renderOrtak() { 
            const ul = document.getElementById('ortak-listesi'); ul.innerHTML=""; 
            window.ortakData.forEach((o,i)=>{ 
                ul.innerHTML+=`
                <li class="flex justify-between p-3 bg-cyan-500/5 rounded-xl border border-cyan-500/20 items-center hover:bg-cyan-500/10 transition-colors select-none">
                    <div class="flex gap-3 items-center">
                        <div class="drag-handle text-cyan-400 hover:text-white text-2xl px-2 cursor-grab">‚ò∞</div>
                        
                        <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center overflow-hidden border border-cyan-500/30">
                            <img src="${o.logo}" class="w-full h-full object-cover">
                        </div>
                        
                        <div><div class="text-sm font-bold text-white">${o.ad}</div><div class="text-xs text-cyan-400">${o.rol}</div></div>
                    </div>
                    <button onclick="ortakSil(${i})" class="text-red-400 font-bold hover:text-red-200">‚úñ</button>
                </li>`
            }); 
        }
        function ortakEkle() { 
            const ad=document.getElementById('ortak-ad').value; 
            const rol=document.getElementById('ortak-rol').value; 
            let logo=document.getElementById('ortak-logo').value; 
            // Logo yoksa harf avatarƒ± yap
            if(!logo) logo = `https://ui-avatars.com/api/?name=${ad}&background=random&color=fff`;

            if(ad && rol){
                window.ortakData.push({ad, rol, logo}); 
                renderOrtak(); 
                document.getElementById('ortak-ad').value=""; document.getElementById('ortak-rol').value=""; document.getElementById('ortak-logo').value=""; 
            } 
        }
        function ortakSil(i) { window.ortakData.splice(i,1); renderOrtak(); }

        // --- Dƒ∞ƒûERLERƒ∞ (AYNI) ---
        function renderEkip() { const ul=document.getElementById('ekip-listesi'); ul.innerHTML=""; window.ekipData.forEach((u,i)=>{ ul.innerHTML+=`<li class="flex justify-between p-3 bg-white/5 rounded-xl border border-white/10 items-center hover:bg-white/10 transition-colors select-none"><div class="flex gap-3 items-center"><div class="drag-handle text-slate-400 hover:text-white text-2xl px-2 cursor-grab">‚ò∞</div><img src="${u.resim}" class="w-10 h-10 rounded-full object-cover"><div><div class="text-sm font-bold text-white">${u.ad}</div><div class="text-xs text-blue-400">${u.gorev}</div></div></div><button onclick="ekipSil(${i})" class="text-red-400 font-bold hover:text-red-200">‚úñ</button></li>`}); }
        function ekipEkle() { const ad=document.getElementById('yeni-ad').value; const gorev=document.getElementById('yeni-gorev').value; let resim=document.getElementById('yeni-resim').value||`https://ui-avatars.com/api/?name=${ad}&background=random`; if(ad){window.ekipData.push({ad,gorev,resim}); renderEkip(); document.getElementById('yeni-ad').value=""} }
        function ekipSil(i) { window.ekipData.splice(i,1); renderEkip(); }
        function renderBlog() { const ul=document.getElementById('blog-listesi'); ul.innerHTML=""; window.blogData.forEach((h,i)=>{ ul.innerHTML+=`<li class="flex gap-4 p-4 bg-purple-500/5 border border-purple-500/20 rounded-xl items-center hover:bg-purple-500/10 transition-colors select-none"><div class="drag-handle text-purple-400 hover:text-white text-2xl px-2 cursor-grab">‚ò∞</div><img src="${h.resim}" class="w-16 h-16 rounded-lg object-cover bg-slate-800 pointer-events-none"><div class="flex-1"><div class="font-bold text-white text-sm">${h.baslik}</div><div class="text-xs text-purple-300 line-clamp-1">${h.metin}</div></div><button onclick="blogSil(${i})" class="text-red-400 font-bold hover:text-red-200">‚úñ</button></li>`}); }
        function blogEkle() { const baslik=document.getElementById('blog-baslik').value; const resim=document.getElementById('blog-resim').value||"https://images.unsplash.com/photo-1504711434969-e33886168f5c?auto=format&fit=crop&w=500&q=80"; const metin=document.getElementById('blog-metin').value; if(baslik&&metin){window.blogData.push({baslik,resim,metin,tarih:new Date().toLocaleDateString('tr-TR')}); renderBlog(); document.getElementById('blog-baslik').value=""; document.getElementById('blog-metin').value=""; document.getElementById('blog-resim').value="";} }
        function blogSil(i) { window.blogData.splice(i,1); renderBlog(); }
        function renderMesajlar() { const d=document.getElementById('mesaj-kutusu'); if(window.mesajlarData.length===0){d.innerHTML='<p class="text-slate-500 text-xs italic">Hen√ºz mesaj yok.</p>';return;} d.innerHTML=""; [...window.mesajlarData].reverse().forEach((m,idx)=>{ const rIdx=window.mesajlarData.length-1-idx; d.innerHTML+=`<div class="bg-white/5 p-4 rounded-xl border border-white/10 relative group"><div class="flex justify-between items-start mb-2"><div><h4 class="font-bold text-yellow-400 text-sm">${m.ad}</h4><p class="text-xs text-slate-400">${m.email}</p></div><span class="text-[10px] text-slate-500 bg-black/30 px-2 py-1 rounded">${m.tarih}</span></div><p class="text-sm text-white">${m.mesaj}</p><button onclick="mesajSil(${rIdx})" class="absolute top-2 right-2 text-red-400 opacity-0 group-hover:opacity-100 font-bold text-xs">Sƒ∞L</button></div>`}); }
        function mesajSil(i){ if(confirm("Silinsin mi?")){window.mesajlarData.splice(i,1); renderMesajlar();} }
        function renderAboneler() { const d=document.getElementById('abone-kutusu'); if(window.abonelerData.length===0){d.innerHTML='<p class="text-slate-500 text-xs italic">Hen√ºz abone yok.</p>';return;} d.innerHTML=""; window.abonelerData.forEach((a,i)=>{ d.innerHTML+=`<div class="bg-green-500/10 border border-green-500/20 px-3 py-1 rounded-lg flex items-center gap-2"><span class="text-sm text-green-300">${a}</span><button onclick="aboneSil(${i})" class="text-red-400 font-bold text-xs">√ó</button></div>`}); }
        function aboneSil(i){ window.abonelerData.splice(i,1); renderAboneler(); }

        // --- KAYDET ---
        async function kaydet() {
            const btn=document.getElementById('btn-kaydet'); const msg=document.getElementById('mesaj');
            btn.innerText="‚è≥ Kaydediliyor..."; btn.classList.add('opacity-50');
            const veri={tarih:document.getElementById('inp-tarih').value, ekip:window.ekipData, ortaklar:window.ortakData, blog:window.blogData, mesajlar:window.mesajlarData, aboneler:window.abonelerData};
            await fetch(DB_URL + "/veri.json", { method: "PUT", body: JSON.stringify(veri) });
            msg.classList.remove('hidden'); btn.innerText="üíæ T√úM√úN√ú KAYDET"; btn.classList.remove('opacity-50'); setTimeout(()=>msg.classList.add('hidden'),3000);
        }
        function cikis() { localStorage.removeItem("admin"); window.location.href = "admin-login.html"; }
    </script>
</body>
</html>